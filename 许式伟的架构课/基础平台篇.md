# 基础平台篇

## 01 | 架构设计的宏观视角

### 为何电脑能够完成这么多复杂而多样的工作

- 可编程性
    - 计算类，也就是支持我们大家都熟知的各类数学运算，如加减乘除、sin/cos 等等。
    - I/O 类，（从存储读写数据）从输入输出设备读数据、写数据。
    - 指令跳转类，在满足特定条件下跳转到新的当前程序执行位置。

- 开放设计的外部设备支持

电脑的 CPU 是一个非常简洁的模型，它只读入和写出数据，对数据进行计算。

直接用机器指令编写软件太累，而且这些机器指令像天书一样没人看得懂，没法维护。所以，编程语言 + 编译器就出现了

多个软件在同一个电脑上怎么共处。多个软件大家往同一个存储地址写数据冲突怎么办？一起往打印机去发送打印指令怎么办？有的软件可能偷偷搞破坏怎么办？于是，操作系统就出现了。

它首先要解决的是软件治理的问题。操作系统其次解决的是基础编程接口问题。

### 完整的程序架构是怎样的

在越强大的基础架构支撑下，应用程序开发需要关注的问题就越收敛，我们的开发效率就越高。在我们只需要关注应用程序本身的业务问题如何构建时，我们说自己是在设计应用程序的业务架构（或者叫“应用架构”）。

对于一个服务端应用程序来说，其完整的架构体系大体如下：

- 业务架构
- 应用程序框架及各类基础库
- 中间件类基础软件，如Nginx，MySQL等
- 操作系统，编程语言
- 冯诺依曼体系架构

### 结语

可能有人看到今天的内容心里会有些担心：“原来架构师要学这么多东西，看来我离成为架构师好远。”

好消息是：我们就是来打消这个担心的。如果我们把写代码的能力比作武功招式，那么架构能力就好比内功。内功修炼好了，武功招式的运用才能得心应手。

而架构能力的提升，本质上是对你的知识脉络（全身经络）的反复梳理与融会贯通的过程。具备架构思维并不难，而且极有必要。不管今天的你是不是团队里的一位架构师，对任何一位程序员来说，具备架构思维将会成为让你脱颖而出的关键。这就像你没有从事云计算行业，但是你仍然需要理解云计算的本质

## 02 | 大厦基石：无生有，有生万物

冯·诺依曼体系结构不但是应用程序这座大厦的地基，同时也是整个信息科技的地基。

为了实现“解决一切可以用‘计算’来解决的问题”这个目标，冯·诺依曼引入了三类基础零部件：

- 中央处理器；
- 存储；
- 输入输出设备。

从中央处理器的角度，存储可简单分为两类：一类是内置支持的存储，通过常规的处理器指令可直接访问，比如寄存器、内存、计算机主板的 ROM。一类是外置存储，它们属于输入输出设备。中央处理器本身并不能直接读写其中的数据。

冯·诺依曼体系中涉及的“存储”，指的是中央处理器内置支持的存储。

也就是说，除了纯正的“计算”能力外，中央处理器还要有“数据交换”能力（或者叫 IO 能力）。最终，电脑可以被看做由 “中央处理器 + 存储 + 一系列的输入输出设备” 构成。

输入输出设备从根本上解决的问题是什么？是电脑无限可能的扩展能力。

架构的第一步是需求分析。从需求分析角度来说，关键要抓住需求的稳定点和变化点。需求的稳定点，往往是系统的核心价值点；而需求的变化点，则往往需要相应去做开放性设计。

对于“电脑”这个产品而言，需求的稳定点是电脑的“计算”能力。需求的变化点，一是用户“计算”需求的多样性，二是用户交互方式的多样性。

电脑的“计算”能力，最终体现为中央处理器的指令集，这是需求相对稳定的部分。

用户“计算”需求的多样性，最终是通过在存储中的指令序列实现。计算机加电启动后，中央处理器并不是按自己固有的“计算”过程进行，而是从一个固定的存储地址加载指令序列执行。

用户交互方式的多样性，则通过定义外部设备与中央处理器的数据交换协议实现。

## 03 | 汇编：编程语言的诞生

为了不再用“0101”表达自己的思想，人们创造了汇编语言，这一步让编程成为一个纯软件行为，程序员这一个分工也由此诞生。

为了进一步支持程序员这个职业，我们设计了 MVP 版（最小化可行产品）的可自我迭代的计算机。有了这个计算机，我们就可以不断演进，并最终演进出今天越来越多姿多彩的信息科技的世界。

## 04 | 编程语言的进化

其一是过程式。过程式就是以一条条命令的方式，让计算机按我们的意愿来执行

其二是函数式。函数式本质上是过程式编程的一种约束，它最核心的主张就是变量不可变，函数尽可能没有副作用

其三是面向对象。面向对象在过程式的基础上，引入了对象（类）和对象方法（类成员函数），它主张尽可能把方法（其实就是过程）归纳到合适的对象（类）上，不主张全局函数（过程）。面向对象语言的代表是 Java、C#、C++、Go 等等。

## 05 | 思考题解读：如何实现可自我迭代的计算机？

做架构，第一件事情要学会做需求分析。

知鱼君注：这一讲很难，不适合架构新手

## 06 | 操作系统进场

从客户需求来说，操作系统的核心价值在于：
- 实现软件治理，让多个软件和谐共处；
- 提供基础的编程接口，降低软件开发难度。

从商业价值来说，操作系统是刚性需求，核心的流量入口，兵家必争之地。所以，围绕它的核心能力，操作系统必然会不断演化出新的形态。

## 07 | 软件运行机制及内存管理

这一讲好难

## 08 | 操作系统内核与编程接口

## 09 | 外存管理与文件系统

## 10 | 输入和输出设备：交互的演进

## 11 | 多任务：进程、线程与协程

