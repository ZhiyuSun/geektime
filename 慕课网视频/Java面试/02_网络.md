# 网络

## OSI七层协议

物理层：比特流。网卡
数据链路层：如何格式化数据，确保数据传输可靠性，比特流组成帧。交换机
网络层：网络地址翻译成物理地址，数据包，IP协议。路由器
传输层：流量控制，TCP/UDP，分段
会话层：建立和管理应用程序员之间的通信
表示层：数据
应用层:HTTP

## TCP/IP

OSI的实现：TCP/IP

应用层：应表会  HTTP数据
传输层：传输层  TCP首部
网络层：网络层  IP首部
链路层：物数    以太网首部

## TCP三次握手

传输控制协议TCP简介：
- 面向连接的，可靠的，基于字节流的传输层通信协议
- 将应用层的数据流分隔成报文段并发送给目标节点的TCP层
- 数据包都有序号，对方收到则发送ACK确认，未收到则重传
- 使用校验和来检验数据在传输过程中是否有误

TCP报文头

TCP Flags
- URG：紧急指针标志
- ACK：确认序号标志
- SYN：同步序号，用于建立连接过程
- FIN：finish标志，用于释放连接

握手是为了建立连接，TCP三次握手的流程图如下：
在TCP/IP协议中，TCP协议提供可靠的连接服务，采用三次握手建立一个连接。
第一次握手：建立连接时，客户端发送SYN包（syn=j）到服务器，并进入SYN_SEND状态，等待服务器确认；
第二次握手：服务器收到SYN包，必须确认客户的SYN（ack=j+1），同时自己也发送一个SYN包（syn=k），即SYN+ACK包，此时服务器进入SYN_RECV状态；
第三次握手：客户端收到服务器的SYN+ACK包，向服务器发送确认包ACK（ack=k+1），此包发送完毕，客户端和服务器进入ESTABLISHED状态，完成三次握手。

为什么需要三次握手才能建立起连接？
为了初始化Sequence Number的初始值

## TCP的四次挥手

挥手是为了终止连接，TCP四次挥手的流程图如下
第一次挥手：Client发送一个FIN，用来关闭Client到Server的数据传送，Client进入FIN_WAIT_1状态
第二次挥手：Server收到FIN后，发送一个ACK给Client，确认序号为收到序号+1（与SYN相同，一个FIN占用一个序号），Server进入CLOSE_WAIT状态
第三次挥手：Server发送一个FIN，用来关闭Server到Client的数据传送，Server进入LAST_ACK状态；
第四次挥手：Client收到FIN后，Client进入TIME_WAIT状态，接着发送一个ACK给Server，确认序号为收到序号+1，Server进入CLOSED状态，完成四次挥手



