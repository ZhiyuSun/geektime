# 一面

## 如何做自我介绍

自我介绍时塑造第一印象的关键，也是你一上来可以掌握主动权的机会

要点
- 简单有力，3-4分钟较好。（凸显自己的能力和经历）
- 内容要有结构性：经历简介、项目经历、技术总结
- 凸显能力：技术经验能力、学习思考能力（凸显技术栈，使用场景，学习思考能力比较深入）

介绍前的思考
- 你的一面面试官和你未来的关系？（一面面试官是同事，体现技术能力，和有亮点的经历）
- 他想要从我的自我介绍中了解什么？

介绍的内容
- 经历简介
    - 个人信息，教育背景，职业生涯，工作年限
- 项目经历
    - 电商项目：微服务，领域模型驱动设计，结果产出，qps，高并发场景，担当什么？
- 技能总结
    - 你的技术栈，开发语言，主要框架，中间件（存储，微服务相关，大数据，部署相关）
    - 业务时间学习 or 最近在学什么

介绍的亮点
- 谦逊：能力再强也需要和谐的研发环境
- 自信：代表了你对个人价值的认可
- 与众不同：深度思考，愿意学习探索

## 聊聊项目

既然你主要做的是电商方向，详细聊聊你做的电商项目吧？

要点
- 项目场景介绍
- 系统架构方案
- 你负责了哪块

### 项目场景介绍

项目做了什么
- B2C的电商平台：标准的电商场景
- 既要有全局思维的广度，又要有局部思维的深度

标准的电商基础模块
- 商家：商家入驻及授权流程
- 店铺：店铺管理
- 用户：用户注册及登录，用户管理模块
- 品牌：品牌管理，品牌授权
- 类目：三级类目管理 服饰——男装——卫衣
- 属性：颜色，尺寸，自定义属性
- 商品：商品管理，库存管理，运费管理

标准的电商应用模块
- 购物车：购物车管理
- 导购：搜索，推荐
- 营销：优惠券，活动
- 交易：订单，支付，退款
- 配送：物流
- 售后：售后，客服

我主要开发的系统
- 商品系统：商品基础模型，商品详情查询
- 交易系统：交易支付，订单列表及支付系统对接

### 系统架构方案

分维度介绍
- 系统架构：体现整体部署结构，选型思考
- 业务架构：业务场景引入进来做业务架构设计

系统架构
- 流量入口
- 服务治理
- 数据选型

普通一线研发
- 快速理解需求，产出代码
- 如何充分单元测试，快速上线
系统负责人
- 对系统的边界职责是否清晰
- 系统稳定性考虑：连接池，监控，限流做了吗
架构师
- 整个链路在电商场景中的位置
- 未来的扩展性
- 如何发现瓶颈，快速解决

### 抛问题说答案

项目过程中你遇到了什么样的难解决问题？你是如何解决的？

什么样的问题是难解决的？
- 常见问题 or 偏门问题（准备常见的，有一定互联网深度的问题）
- 正常问题 or 踩坑问题

面试官主要是想看下你做的内容的深度实操经验以及你解决问题的思考和手段

### 举例

交易一致性问题
- 重复支付（支付系统因为各种原因重复回调）（考察点：幂等方法）
    - 防重，可重试的幂等性
        - 悲观锁（select * form order info where id="20201020" for update 行锁）（第二个请求会被阻塞）
        - 乐观锁（update order_info set status="成功" where id="20201020" and status="初始"。影响行数若为1，则发货）
        - 乐观锁优于悲观锁，悲观锁会被阻塞。订单的防重一般都会选择乐观锁机制
- 超时退问题（考察点：分布式事务，流水号应用，重试方法）
    - 如何回滚内容
    - 回滚失败如何解决
    - 重复回滚如何预防

分布式原理（CAP）
- 一致性（Consistency）:客户端知道一系列的操作都会同时发生（生效）
- 可用性（Availability）：每个操作都必须以可预期的响应结束
- 分区容错性（Partition tolerance）：即使出现单个组件无法可用，操作依然可以完成
分布式系统，分区容错性一定要保证，如何在一致性和可用性做出取舍（强一致性VS弱一致性）

BASE（保护A，牺牲C）
- Basically Available(基本可用)
- Soft state(软状态)(A分区和B分区的状态可能不一致)
- Eventually consistent(最终一致性)

分布式事务
- 二阶段提交（保证强一致性）
- 异步确保型（保证可用性，最终一致性）
- 事务型消息（保证可用性，最终一致性）
- TCC型（保证可用性，最终一致性）

强一致性保证
- 二阶段提交(牺牲可用性，保证强一致性)（锁行、锁表情况会非常严重）
- 读写相等
- Raft协议
（通过transaction Manager的中间层，收到两个server的ack，再commit）

TCC
- try
- confirm
- cancel
（运用stock_log,voucher_log，xid）


raft同步
- 异步同步：最终一致性
- 同步同步：强制要求所有follower节点写成功才算成功，配合二阶段提交才可以保证强一致（对集群的吞吐量影响较大）
- raft同步：要求超过一半以上的节点同步成功即可算写成功，外加二阶段提交
zookeeper是按二阶段提交做的


异步确保性
- 采用异步消息的方式确保事务可以最终一致
（消息中间件，持久化磁盘，消费回滚操作消息，仍然做幂等）


事务型消息
- 使用事务型消息确保发送方的落地能力

## 提问环节

面试官提问：有没有遇到java程序崩溃问题？如何排查？

### 通用jvm工具

- jps:虚拟机进程状态工具
    - jps -v | grep 6783
- jinfo：jvm参数信息工具
    - jinfo -flags pid
- jstat:查看虚拟机各种运算状态
    - 示例：jstat -gcutil pid
        - S0：新生代中s0区已使用空间的百分比
        - S1：新生代中S1区已使用空间的百分比
        - E：新生代已使用空间的百分比
        - O：老年代已使用空间的百分比
        - M：元数据区已使用空间的百分比
        - CCS：压缩类空间利用率百分比
        - YGC:从应用程序启动到当前，发生Young GC的次数
        - YGCT：从应用程序启动到当前，Young GC所用的时间【单位：秒】
        - FGC:从应用程序启动到当前，发生Full GC的次数
        - FGCT：从应用程序启动到当前，Full GC所用的时间【单位：秒】
        - GCT：从应用程序启动到当前，用于垃圾回收的总时间【单位：秒】
- jstack: 线程快照工具
    - 示例：jstack -l pid（可排查锁）
- jmap：HeapDump工具
    - 示例：
        - jmap -heap pid 查看堆信息
        - jamp -dump:format=b,file=heapDUmp.hprof pid 导出堆文件并用jhat查看
        - jhat -port 8899 heapDump.hprof 浏览器访问
- 线上OOM问题排查
    - java -Xms48m -Xmx48m -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=./heapdump.hprof -jar mianshi.jar
    - 使用jprofiler查看dump文件及call tree分析

## 你有什么要问的吗

背景：一面的面试官和你职级相同
信息了解：最好的了解实际工作内容和细节的机会
坦诚表现：对岗位的表现浓厚兴趣

## 一面雷点提示

场景问题及踩坑

避免踩坑
- 一定要准备的很清晰，不能在项目结构上有盲点，否则容易被深问
- 不是自己负责的部分要么就弄清楚，要么就直接说不清楚