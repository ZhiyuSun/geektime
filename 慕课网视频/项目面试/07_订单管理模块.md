# 订单管理模块

订单中包括了商品，优惠，用户，收获信息，支付信息等一系列实时数据

大型电商系统的订单模块更加复杂，包括订单自动合并与拆分、自动匹配仓库、自动计算库存、自动匹配快递、结算与支付等作业。

## 电商系统核心模块

商品模块，订单模块，支付模块

购物车记录
通常来说购物车中的记录时要持久存储的，存放在NoSQL居多

## 面试题

- 你能讲一下订单生产的流程吗？
- 如果商品下架了，但是用户没有刷新页面就下单了，后台程序应该怎么处理？
- 扣减库存是什么时候？订单取消后，怎么恢复库存（用户下订单之后扣减库存，取消订单恢复库存）
- 扣减库存怎么保证幂等性（三种，数据库事务级别串行化，严重降低了并发性，加悲观锁很容易引发死锁，加乐观锁，是保证幂等性的最好方案。不要一上来把答案说出来，分析每种方式的优缺点）
- 怎么保证订单号是不重复的（雪花算法，增大长度，避免重复订单号）
- 订单号和流水号是不是一回事儿（流水号是对内公开的，订单号是对外开放的）
- 订单记录怎么引用收货人地址（不能引用id）
- 订单表是怎么设计的（订单表，订单商品表，一对多）
- 你的电商项目中有没有订单拆分功能？（按发货仓库拆分，等）
- 你能说说订单有几种取消的形式吗（客户取消，卖家取消，系统自动取消）

## 开通移动支付

没有看

## 支付面试题

- 你做的电商系统都支持什么移动支付平台？
- 你都做了支付模块的哪些部分？
- 小程序的微信支付流程？
- 申请微信支付的流程？
- JSAPI支付，H5支付，以及小程序支付的区别？
- 微信支付的数字签名是怎么生成的？
- 如果用户支付成功，商户系统没有收到通知该怎么办？
- 微信平台支付订单不付款的超时是多久？
- 微信支付的return_code和result_code的区别
- 如果用户支付成功，但是看到订单状态未支付，于是又去支付了一次，你的系统怎么避免这种情况
- 用户长时间没有付款，商户系统应不应该关闭订单，但是会出现什么后果
- 会不会出现微信提示支付失败，但是银行卡扣款成功的结果
- 移动支付平台会不会出现重复扣款的现象

