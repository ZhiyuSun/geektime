# 事务型消息

因为是rocketmq，所以没深入学习

## 操作流水

数据类型
- 主业务数据：master data
- 操作型数据：log data

增加一张log表，
这个跟学到的TCC原理相同

先初始化一条库存流水

库存数据库最终一致性保证
方案：
- 引入库存操作流水
- 引入事务性消息机制

问题：
- redis不可用时如何处理
- 扣减流水错误如何处理

业务场景决定高可用技术实现
设计原则：
- 宁可少卖，不能超卖
- 